{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_lista","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_ordemAtual","_service","NegociacoesService","_init","lista","then","negociacoes","forEach","adiciona","item","catch","texto","erro","setInterval","_importaNegociacoes","event","preventDefault","negociacao","_criaNegociacao","cadastra","mensagem","_limpaFormulario","Negociacao","DateHelper","textToDate","value","parseInt","parseFloat","focus","apaga","esvazia","importa","coluna","inverteOrdem","ordena","a","b"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController {\r\n    constructor (){\r\n        let $ = document.querySelector.bind(document);\r\n    \r\n        this._inputData = $(\"#data\");\r\n        this._inputQuantidade = $(\"#quantidade\");\r\n        this._inputValor = $(\"#valor\");     \r\n\r\n        this._lista = new Bind(new ListaNegociacoes(), new NegociacoesView($(\"#tableNegociacoes\")), 'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\r\n        this._mensagem = new Bind(new Mensagem(), new MensagemView($(\"#mensagemView\")), 'texto');    \r\n\r\n        this._ordemAtual = '';\r\n        this._service = new NegociacoesService();        \r\n        this._init();      \r\n    }\r\n\r\n    _init(){\r\n        this._service\r\n            .lista()\r\n            .then(negociacoes => \r\n                negociacoes.forEach(item => \r\n                    { this._lista.adiciona(item) }\r\n                )\r\n            )\r\n            .catch(erro => this._mensagem.texto = erro);              \r\n\r\n        setInterval(() => {\r\n            this._importaNegociacoes();\r\n        }, 3000);\r\n    }\r\n\r\n    adiciona(event){\r\n\r\n        event.preventDefault();\r\n        let negociacao = this._criaNegociacao();\r\n\r\n        this._service\r\n            .cadastra(negociacao)\r\n            .then(mensagem => {\r\n                this._lista.adiciona(negociacao);\r\n                this._mensagem.texto = mensagem;\r\n                this._limpaFormulario();\r\n            })\r\n            .catch(erro => this._mensagem.texto = erro);       \r\n    }\r\n\r\n    _criaNegociacao(){\r\n        return new Negociacao(\r\n            DateHelper.textToDate(this._inputData.value),\r\n            parseInt(this._inputQuantidade.value),\r\n            parseFloat(this._inputValor.value)\r\n        );\r\n    }\r\n\r\n\r\n    _limpaFormulario() {\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value = 1;\r\n        this._inputValor.value = 0.0;\r\n        this._inputData.focus();\r\n    }\r\n\r\n    apaga() {\r\n        this._service\r\n        .apaga()\r\n        .then(mensagem => {\r\n            this._lista.esvazia();\r\n                this._mensagem.texto = mensagem;\r\n        })\r\n        .catch(erro => this._mensagem.texto = erro);              \r\n    }\r\n\r\n    _importaNegociacoes() {\r\n\r\n\r\n        this._service\r\n            .importa(this._lista)\r\n            .then(negociacoes => negociacoes.forEach(negociacao => {\r\n                this._lista.adiciona(negociacao);\r\n                this._mensagem.texto = 'Negociações do período importadas'   \r\n            }))\r\n            .catch(erro => this._mensagem.texto = erro); \r\n    }\r\n\r\n    ordena(coluna){\r\n        if(this._ordemAtual == coluna){\r\n            this._lista.inverteOrdem();\r\n        }else{\r\n            this._lista.ordena((a, b) => a[coluna] - b[coluna]);\r\n        }\r\n        this._ordemAtual = coluna;\r\n    }\r\n\r\n\r\n    \r\n    \r\n}"]}